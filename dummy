import { createApi } from "@reduxjs/toolkit/query/react";
import { customBaseQuery } from "../../app/commonApi";

export const interestRateFixationApi = createApi({
    reducerPath: 'interestRateFixationApi',
    baseQuery: customBaseQuery,
    tagTypes: ['BriefBackground', 'InternalRating', 'ExternalRating'],
    endpoints: (builder) => ({
        getFixationInterestRate: builder.query<any, string>({
            query: (applId) => `interestratefixation/getfixationinterestrate/${applId}`,
            providesTags: ['BriefBackground']
        }),
        saveInternalRating: builder.mutation<any, any[]>({
            query: (data) => ({
                url: `interestratefixation/saveinternalrating`,
                method: 'POST',
                body: data,
            }),
            invalidatesTags: ['InternalRating'],
        }),
        getInternalRatingPresent: builder.query<any, string>({
            query: (applId) => `interestratefixation/getinternalratingpresent/${applId}`,
            providesTags: ['InternalRating']
        }),
        getInternalRatingSanction: builder.query<any, string>({
            query: (applId) => `interestratefixation/getinternalratingsanction/${applId}`,
            providesTags: ['InternalRating']
        }),
        getExternalRatingSanction: builder.query<any, string>({
            query: (applId) => `interestratefixation/getexternalratingsanction/${applId}`,
            providesTags: ['ExternalRating']
        }),
        getExternalRatingPresent: builder.query<any, string>({
            query: (applId) => `interestratefixation/getexternalratingpresent/${applId}`,
            providesTags: ['ExternalRating']
        }),
        saveExternalRating: builder.mutation<any, any[]>({
            query: (data) => ({
                url: `interestratefixation/saveexternalrating`,
                method: 'POST',
                body: data,
            }),
            invalidatesTags: ['ExternalRating'],
        }),
    }),
});

export const {
    useGetFixationInterestRateQuery,
    useSaveInternalRatingMutation,
    useGetInternalRatingPresentQuery,
    useGetInternalRatingSanctionQuery,
    useGetExternalRatingSanctionQuery,
    useGetExternalRatingPresentQuery,
    useSaveExternalRatingMutation,
} = interestRateFixationApi;


import React from 'react';
import { Table, TableBody, TableCell, TableHead, TableRow } from "@mui/material";
import { useGetFixationInterestRateQuery } from './path/to/interestRateFixationApi'; // Adjust the import path

interface RfBriefBackgroundProps {
    applId: string;
}

export const RfBriefBackground: React.FC<RfBriefBackgroundProps> = ({ applId }) => {
    const { data, isLoading, error } = useGetFixationInterestRateQuery(applId);

    if (isLoading) {
        return <div>Loading...</div>;
    }

    if (error) {
        return <div>Error fetching data</div>;
    }

    const backgroundData = data?.data;

    return (
        <div className="wrap-inner-table mt-0">
            <Table sx={{ minWidth: 650 }} aria-label="brief background table">
                <TableHead>
                    <TableRow>
                        <TableCell style={{ width: '6%' }}><b>Sr. No.</b></TableCell>
                        <TableCell style={{ width: '20%' }}><b>Particulars</b></TableCell>
                        <TableCell><b>Remarks</b></TableCell>
                    </TableRow>
                </TableHead>
                <TableBody>
                    <TableRow>
                        <TableCell>1</TableCell>
                        <TableCell>Name of the Borrower</TableCell>
                        <TableCell>{backgroundData?.nameOfBorrower || 'N/A'}</TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>2</TableCell>
                        <TableCell>Scheme</TableCell>
                        <TableCell>{backgroundData?.schCd || 'N/A'}</TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>3</TableCell>
                        <TableCell>Sanctioned amount</TableCell>
                        <TableCell>
                            <strong>TL of ₹ {backgroundData?.sanctionAmt || '0'} crore</strong>
                        </TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>4</TableCell>
                        <TableCell>Details of Sanction</TableCell>
                        <TableCell>
                            Sanctioned by <strong>{backgroundData?.sancBy || 'N/A'}</strong> in its <strong>{backgroundData?.meetingNo || '0'}</strong> meeting held on <strong>{backgroundData?.meetingDate ? new Date(backgroundData.meetingDate).toLocaleDateString() : 'N/A'}</strong>.
                        </TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>5</TableCell>
                        <TableCell>Validity of Sanction</TableCell>
                        <TableCell>{backgroundData?.sancValidity ? new Date(backgroundData.sancValidity).toLocaleDateString() : 'N/A'}</TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>6</TableCell>
                        <TableCell>Rate of interest as per sanctioned terms/ Validity of interest rate</TableCell>
                        <TableCell>
                            <strong>{backgroundData?.sancBy || 'N/A'}</strong> has sanctioned term loan of <strong>{backgroundData?.sanctionAmt || '0'} crore</strong> to {backgroundData?.nameOfBorrower || 'N/A'} and requested for approval from <strong>{backgroundData?.sancBy || 'N/A'}</strong> for RoI of {backgroundData?.disbRate || 'N/A'}% by exercising discretion of discretion from minutes/appraisal valid till <strong>{backgroundData?.meetingDate ? new Date(backgroundData.meetingDate).toLocaleDateString() : 'N/A'}</strong>.
                        </TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>7</TableCell>
                        <TableCell>Disbursement already made out of above sanction / present o/s. under loan</TableCell>
                        <TableCell>{backgroundData?.presentOs || 'N/A'}</TableCell>
                    </TableRow>
                    <TableRow>
                        <TableCell>8</TableCell>
                        <TableCell>Present total o/s under all loans</TableCell>
                        <TableCell>
                            <div className="alnSet">₹ {backgroundData?.presentTotalOs || '0'} crore</div>
                        </TableCell>
                    </TableRow>
                </TableBody>
            </Table>
        </div>
    );
};
