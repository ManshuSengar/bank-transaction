import React from 'react';
import { useField } from 'formik';
import ReactQuill from 'react-quill';
import 'react-quill/dist/quill.snow.css';
import Grid from "@mui/material/Grid";
import Typography from "@mui/material/Typography";
import { removeRestrictedCharacters } from '../../utlis/input';

export const RichTextField: React.FC<{
    label?: string;
    name: string;
    disabled?: boolean;
    className?:string;
    restrictedCharacters?: string; 
}> = ({ label, name, disabled, className, restrictedCharacters }) => {
    const [field, meta, helpers] = useField(name);

    const handleChange = (content: string) => {
        let newContent = content;
        
        if (restrictedCharacters) {
            newContent = removeRestrictedCharacters(content, restrictedCharacters);
        }
        
        helpers?.setValue(newContent);
    };

    return (
        <Grid item xs={12}>
            <Typography variant="subtitle1" gutterBottom>
                {label}
            </Typography>
            <ReactQuill
            className={className}
                readOnly={disabled}
                theme="snow"
                value={field?.value || ''}
                onChange={handleChange}
                modules={{
                    toolbar: [
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered' }, { 'list': 'bullet' }, { 'indent': '-1' }, { 'indent': '+1' }],
                        ['link'],
                    ],
                }}
            />
            {meta.touched && meta.error ? (
                <Typography color="error" variant="subtitle2" gutterBottom>
                    {meta?.error}
                </Typography>
            ) : null}
        </Grid>
    );
};
