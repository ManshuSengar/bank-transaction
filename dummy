import { useState, useEffect } from "react";
import { FieldArray, Form, Formik } from 'formik';
import AutoSave from '../../../components/framework/AutoSave';
import { Button, Table, TableBody, TableCell, TableHead, TableRow } from "@mui/material";
import CheckCircleOutlineIcon from '@mui/icons-material/CheckCircleOutline';
import { AdvanceTextBoxField } from "../../../components/framework/AdvanceTextBoxField";
import ConfirmationAlertDialog from "../../../models/application-form/ConfirmationAlertDialog";
import SaveAsIcon from '@mui/icons-material/SaveAs';
import { OnlineSnackbar } from "../../../components/shared/OnlineSnackbar";
import { useSaveRepsessionDetailsMutation, useGetRepsessionDetailQuery } from "../../../features/application-form/Portfoliocuts";
import { useAppSelector } from "../../../app/hooks";

const RepossessionDetails = () => {
    const { applId, transactionData } = useAppSelector((state) => state.userStore);
    const [saveRepsessionDetails] = useSaveRepsessionDetailsMutation();
    const { data: repsessionData } = useGetRepsessionDetailQuery(applId, { refetchOnMountOrArgChange: true });
    const [initialValues, setInitialValues] = useState<any>({ data: [] });
    const [openConfirmation, setOpenConfirmation] = useState(false);
    const [formData, setFormData] = useState<any>("");
    const [actionVal, setActionVal] = useState<any>("");
    const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);
    const [snackMsg, setSnackMsg] = useState<any>("");
    const [severity, setSeverity] = useState<string>("success");

    useEffect(() => {
        if (repsessionData) {
            setInitialValues({ data: repsessionData });
        }
    }, [repsessionData, applId]);

    const handleSubmitApis = async (values: any) => {
        let finalValue = values?.data?.map((listData: any, index: number) => {
            return {
                ...listData,
                applId,
                slNo: index + 1
            };
        });

        try {
            if (await saveRepsessionDetails(finalValue).unwrap()) {
                setOpenSnackbar(true);
                setSeverity("success");
                if (finalValue?.[0]?.saveStatus === '02') {
                    setSnackMsg("Section submitted successfully");
                } else {
                    setSnackMsg("Record saved successfully");
                }
                return true;
            }
        } catch (error: any) {
            setOpenSnackbar(true);
            setSeverity("error");
            setSnackMsg("Failed to save: " + error?.message);
            return false;
        }
    };

    const handleClose = () => {
        setOpenSnackbar(false);
    };

    const handleCloseConfirmation = () => {
        setActionVal(null);
        setOpenConfirmation(false);
    };

    const handleSubmitConfirmation = (values: any) => {
        const finalValue = values?.data?.map((listData: any) => {
            return {
                ...listData,
                saveStatus: '02'
            };
        });
        setOpenConfirmation(false);
        handleSubmitApis(finalValue);
    };

    const handleSubmit = async (values: any) => {
        if (actionVal === '02') {
            setFormData(values);
            setOpenConfirmation(true);
        } else {
            handleSubmitApis(values);
        }
        setActionVal(null);
    };

    const handleClickSetAction = (action: any) => {
        setActionVal(action);
    };

    // Check if a row is the total/summary row
    const isTotalRow = (item: any, index: number, dataLength: number) => {
        return item?.particulares?.toLowerCase().includes('total') || 
               item?.particulares?.toLowerCase().includes('net') ||
               index === dataLength - 1;
    };

    // Auto-calculation component that watches form values
    const AutoCalculation = ({ values, setFieldValue }: any) => {
        useEffect(() => {
            if (!values?.data || values.data.length === 0) return;

            const dataLength = values.data.length;
            const lastIndex = dataLength - 1;
            
            // Find the total row (last row or row with 'total'/'net')
            let totalRowIndex = -1;
            for (let i = dataLength - 1; i >= 0; i--) {
                if (isTotalRow(values.data[i], i, dataLength)) {
                    totalRowIndex = i;
                    break;
                }
            }

            if (totalRowIndex === -1 || totalRowIndex === 0) return;

            // Calculate sums for each column
            const columns = ['valAsonT2', 'valAsonT1', 'valAsonT'];
            
            columns.forEach(column => {
                let sum = 0;
                
                // Sum all rows except the total row
                for (let i = 0; i < totalRowIndex; i++) {
                    const value = parseFloat(values.data[i][column]) || 0;
                    sum += value;
                }
                
                // Only update if the value has changed to prevent infinite loops
                const currentTotal = parseFloat(values.data[totalRowIndex][column]) || 0;
                const newTotal = parseFloat(sum.toFixed(2));
                
                if (currentTotal !== newTotal) {
                    setFieldValue(`data.${totalRowIndex}.${column}`, newTotal.toFixed(2));
                }
            });

        }, [values?.data, setFieldValue]);

        return null; // This component doesn't render anything
    };

    return (
        <>
            <div className="custome-form">
                <ConfirmationAlertDialog
                    id={applId as unknown as number}
                    type={4}
                    open={openConfirmation}
                    handleClose={handleCloseConfirmation}
                    handleDelete={handleSubmitConfirmation}
                    values={formData}
                />
                <div className="wrap-inner-table" style={{ overflow: 'auto' }}>
                    <Formik
                        initialValues={initialValues}
                        onSubmit={handleSubmit}
                        enableReinitialize
                    >
                        {({ values, setFieldValue }) => {
                            return (
                                <Form>
                                    {/* Auto-calculation component */}
                                    <AutoCalculation values={values} setFieldValue={setFieldValue} />
                                    
                                    <fieldset disabled={values?.data?.[0]?.saveStatus === "02"}>
                                        {values?.data?.[0]?.saveStatus !== "02" &&
                                            <AutoSave handleSubmit={handleSubmit} values={values} debounceMs={10000} autoStyle={true} />
                                        }
                                        <FieldArray name="data">
                                            {() => (
                                                <Table sx={{ minWidth: 650 }} aria-label="simple table">
                                                    <TableHead>
                                                        <TableRow>
                                                            <TableCell><b>Sr. No.</b></TableCell>
                                                            <TableCell><b>Particulars</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrTm2}</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrTm1}</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrT}</b></TableCell>
                                                        </TableRow>
                                                    </TableHead>
                                                    <TableBody>
                                                        {values?.data?.map((item: any, index: number) => {
                                                            const isTotal = isTotalRow(item, index, values.data.length);
                                                            
                                                            return (
                                                                <TableRow
                                                                    key={index}
                                                                    sx={isTotal ? {
                                                                        backgroundColor: "#f5f5f5",
                                                                        fontWeight: "bold",
                                                                        '& .MuiTableCell-root': {
                                                                            fontWeight: 'bold'
                                                                        }
                                                                    } : {}}
                                                                >
                                                                    <TableCell sx={isTotal ? { fontWeight: 'bold' } : {}}>
                                                                        {index + 1}
                                                                    </TableCell>
                                                                    <TableCell sx={isTotal ? { fontWeight: 'bold' } : {}}>
                                                                        {item?.particulares}
                                                                    </TableCell>
                                                                    <TableCell>
                                                                        <AdvanceTextBoxField
                                                                            name={`data.${index}.valAsonT2`}
                                                                            label={isTotal ? "" : "Enter only Number"}
                                                                            type={'number'}
                                                                            disabled={isTotal}
                                                                            inputProps={{
                                                                                style: isTotal ? { 
                                                                                    fontWeight: 'bold',
                                                                                    backgroundColor: '#f5f5f5'
                                                                                } : {}
                                                                            }}
                                                                        />
                                                                    </TableCell>
                                                                    <TableCell>
                                                                        <AdvanceTextBoxField
                                                                            name={`data.${index}.valAsonT1`}
                                                                            label={isTotal ? "" : "Enter only Number"}
                                                                            type={'number'}
                                                                            disabled={isTotal}
                                                                            inputProps={{
                                                                                style: isTotal ? { 
                                                                                    fontWeight: 'bold',
                                                                                    backgroundColor: '#f5f5f5'
                                                                                } : {}
                                                                            }}
                                                                        />
                                                                    </TableCell>
                                                                    <TableCell>
                                                                        <AdvanceTextBoxField
                                                                            name={`data.${index}.valAsonT`}
                                                                            label={isTotal ? "" : "Enter only Number"}
                                                                            type={'number'}
                                                                            disabled={isTotal}
                                                                            inputProps={{
                                                                                style: isTotal ? { 
                                                                                    fontWeight: 'bold',
                                                                                    backgroundColor: '#f5f5f5'
                                                                                } : {}
                                                                            }}
                                                                        />
                                                                    </TableCell>
                                                                </TableRow>
                                                            );
                                                        })}
                                                    </TableBody>
                                                </Table>
                                            )}
                                        </FieldArray>
                                    </fieldset>
                                    {values?.data?.[0]?.saveStatus !== "02" &&
                                        <Button
                                            className="sbmtBtn psn_btn mt-3 mb-3 ms-3"
                                            type='submit'
                                            onClick={() => handleClickSetAction('01')}
                                            variant="contained"
                                        >
                                            Save <CheckCircleOutlineIcon />
                                        </Button>
                                    }
                                    {values?.data?.[0]?.saveStatus !== "02" &&
                                        <Button
                                            className="sbmtBtn sbmtBtn_scn psn_btn mt-3 mb-3 ms-3"
                                            type='submit'
                                            onClick={() => handleClickSetAction('02')}
                                            variant="contained"
                                        >
                                            Submit <SaveAsIcon />
                                        </Button>
                                    }
                                </Form>
                            );
                        }}
                    </Formik>
                </div>
            </div>
            <OnlineSnackbar
                open={openSnackbar}
                msg={snackMsg}
                severity={severity}
                handleSnackClose={handleClose}
            />
        </>
    );
};

export default RepossessionDetails;






import { useState, useEffect } from "react";
import { FieldArray, Form, Formik } from 'formik';
import AutoSave from '../../../components/framework/AutoSave';
import { Button, Table, TableBody, TableCell, TableHead, TableRow } from "@mui/material";
import CheckCircleOutlineIcon from '@mui/icons-material/CheckCircleOutline';
import { AdvanceTextBoxField } from "../../../components/framework/AdvanceTextBoxField";
import ConfirmationAlertDialog from "../../../models/application-form/ConfirmationAlertDialog";
import SaveAsIcon from '@mui/icons-material/SaveAs';
import { OnlineSnackbar } from "../../../components/shared/OnlineSnackbar";
import { useSaveRepsessionDetailsMutation, useGetRepsessionDetailQuery } from "../../../features/application-form/Portfoliocuts";
import { useAppSelector } from "../../../app/hooks";

const RepossessionDetails = () => {
    const { applId, transactionData } = useAppSelector((state) => state.userStore);
    const [saveRepsessionDetails] = useSaveRepsessionDetailsMutation();
    const { data: repsessionData } = useGetRepsessionDetailQuery(applId, { refetchOnMountOrArgChange: true });
    const [initialValues, setInitialValues] = useState<any>({ data: [] });
    const [openConfirmation, setOpenConfirmation] = useState(false);
    const [formData, setFormData] = useState<any>("");
    const [actionVal, setActionVal] = useState<any>("");
    const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);
    const [snackMsg, setSnackMsg] = useState<any>("");
    const [severity, setSeverity] = useState<string>("success");

    useEffect(() => {
        if (repsessionData) {
            setInitialValues({ data: repsessionData });
        }
    }, [repsessionData, applId]);

    const handleSubmitApis = async (values: any) => {
        let finalValue = values?.data?.map((listData: any, index: number) => {
            return {
                ...listData,
                applId,
                slNo: index + 1
            };
        });

        try {
            if (await saveRepsessionDetails(finalValue).unwrap()) {
                setOpenSnackbar(true);
                setSeverity("success");
                if (finalValue?.[0]?.saveStatus === '02') {
                    setSnackMsg("Section submitted successfully");
                } else {
                    setSnackMsg("Record saved successfully");
                }
                return true;
            }
        } catch (error: any) {
            setOpenSnackbar(true);
            setSeverity("error");
            setSnackMsg("Failed to save: " + error?.message);
            return false;
        }
    };

    const handleClose = () => {
        setOpenSnackbar(false);
    };

    const handleCloseConfirmation = () => {
        setActionVal(null);
        setOpenConfirmation(false);
    };

    const handleSubmitConfirmation = (values: any) => {
        const finalValue = values?.data?.map((listData: any) => {
            return {
                ...listData,
                saveStatus: '02'
            };
        });
        setOpenConfirmation(false);
        handleSubmitApis(finalValue);
    };

    const handleSubmit = async (values: any) => {
        if (actionVal === '02') {
            setFormData(values);
            setOpenConfirmation(true);
        } else {
            handleSubmitApis(values);
        }
        setActionVal(null);
    };

    const handleClickSetAction = (action: any) => {
        setActionVal(action);
    };

    // Improved calculation function
    const calculation = (setFieldValue: any, values: any, column: string) => {
        if (!values?.data || values.data.length === 0) return;
        
        const lastIndex = values.data.length - 1;
        const lastRow = values.data[lastIndex];
        
        // Check if the last row is a total row (you can customize this condition)
        const isTotalRow = lastRow?.particulares?.toLowerCase().includes('total') || 
                          lastRow?.particulares?.toLowerCase().includes('net') ||
                          lastIndex === values.data.length - 1; // or simply make last row always total
        
        if (isTotalRow && lastIndex > 0) {
            let sum = 0;
            
            // Calculate sum of all rows except the last one (total row)
            for (let i = 0; i < lastIndex; i++) {
                const value = parseFloat(values.data[i][column]) || 0;
                sum += value;
            }
            
            console.log(`Calculating ${column} - Sum: ${sum} for rows 0 to ${lastIndex - 1}`);
            
            // Set the calculated sum to the last row
            setFieldValue(`data.${lastIndex}.${column}`, sum.toFixed(2));
        }
    };

    // Function to calculate all columns for total row
    const calculateAllColumns = (setFieldValue: any, values: any) => {
        if (!values?.data || values.data.length === 0) return;
        
        const lastIndex = values.data.length - 1;
        const lastRow = values.data[lastIndex];
        
        // Check if the last row is a total row
        const isTotalRow = lastRow?.particulares?.toLowerCase().includes('total') || 
                          lastRow?.particulares?.toLowerCase().includes('net') ||
                          lastIndex === values.data.length - 1;
        
        if (isTotalRow && lastIndex > 0) {
            // Calculate for all three columns
            ['valAsonT2', 'valAsonT1', 'valAsonT'].forEach(column => {
                let sum = 0;
                for (let i = 0; i < lastIndex; i++) {
                    const value = parseFloat(values.data[i][column]) || 0;
                    sum += value;
                }
                setFieldValue(`data.${lastIndex}.${column}`, sum.toFixed(2));
            });
        }
    };

    // Check if a row is the total/summary row
    const isTotalRow = (item: any, index: number, dataLength: number) => {
        return item?.particulares?.toLowerCase().includes('total') || 
               item?.particulares?.toLowerCase().includes('net') ||
               index === dataLength - 1; // or simply make last row always total
    };

    return (
        <>
            <div className="custome-form">
                <ConfirmationAlertDialog
                    id={applId as unknown as number}
                    type={4}
                    open={openConfirmation}
                    handleClose={handleCloseConfirmation}
                    handleDelete={handleSubmitConfirmation}
                    values={formData}
                />
                <div className="wrap-inner-table" style={{ overflow: 'auto' }}>
                    <Formik
                        initialValues={initialValues}
                        onSubmit={handleSubmit}
                        enableReinitialize
                    >
                        {({ values, setFieldValue }) => {
                            return (
                                <Form>
                                    <fieldset disabled={values?.data?.[0]?.saveStatus === "02"}>
                                        {values?.data?.[0]?.saveStatus !== "02" &&
                                            <AutoSave handleSubmit={handleSubmit} values={values} debounceMs={10000} autoStyle={true} />
                                        }
                                        <FieldArray name="data">
                                            {() => (
                                                <Table sx={{ minWidth: 650 }} aria-label="simple table">
                                                    <TableHead>
                                                        <TableRow>
                                                            <TableCell><b>Sr. No.</b></TableCell>
                                                            <TableCell><b>Particulars</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrTm2}</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrTm1}</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrT}</b></TableCell>
                                                        </TableRow>
                                                    </TableHead>
                                                    <TableBody>
                                                        {values?.data?.map((item: any, index: number) => {
                                                            const isTotal = isTotalRow(item, index, values.data.length);
                                                            
                                                            return (
                                                                <TableRow
                                                                    key={index}
                                                                    sx={isTotal ? {
                                                                        backgroundColor: "gray.100",
                                                                        fontWeight: "bold"
                                                                    } : {}}
                                                                >
                                                                    <TableCell>{index + 1}</TableCell>
                                                                    <TableCell>{item?.particulares}</TableCell>
                                                                    <TableCell>
                                                                        <AdvanceTextBoxField
                                                                            name={`data.${index}.valAsonT2`}
                                                                            label={isTotal ? "" : "Enter only Number"}
                                                                            onCustomChange={() => {
                                                                                if (!isTotal) {
                                                                                    // Small delay to ensure the field value is updated before calculation
                                                                                    setTimeout(() => {
                                                                                        calculation(setFieldValue, values, 'valAsonT2');
                                                                                    }, 10);
                                                                                }
                                                                            }}
                                                                            type={'number'}
                                                                            disabled={isTotal}
                                                                        />
                                                                    </TableCell>
                                                                    <TableCell>
                                                                        <AdvanceTextBoxField
                                                                            name={`data.${index}.valAsonT1`}
                                                                            label={isTotal ? "" : "Enter only Number"}
                                                                            onCustomChange={() => {
                                                                                if (!isTotal) {
                                                                                    setTimeout(() => {
                                                                                        calculation(setFieldValue, values, 'valAsonT1');
                                                                                    }, 10);
                                                                                }
                                                                            }}
                                                                            type={'number'}
                                                                            disabled={isTotal}
                                                                        />
                                                                    </TableCell>
                                                                    <TableCell>
                                                                        <AdvanceTextBoxField
                                                                            name={`data.${index}.valAsonT`}
                                                                            label={isTotal ? "" : "Enter only Number"}
                                                                            onCustomChange={() => {
                                                                                if (!isTotal) {
                                                                                    setTimeout(() => {
                                                                                        calculation(setFieldValue, values, 'valAsonT');
                                                                                    }, 10);
                                                                                }
                                                                            }}
                                                                            type={'number'}
                                                                            disabled={isTotal}
                                                                        />
                                                                    </TableCell>
                                                                </TableRow>
                                                            );
                                                        })}
                                                    </TableBody>
                                                </Table>
                                            )}
                                        </FieldArray>
                                    </fieldset>
                                    {values?.data?.[0]?.saveStatus !== "02" &&
                                        <Button
                                            className="sbmtBtn psn_btn mt-3 mb-3 ms-3"
                                            type='submit'
                                            onClick={() => handleClickSetAction('01')}
                                            variant="contained"
                                        >
                                            Save <CheckCircleOutlineIcon />
                                        </Button>
                                    }
                                    {values?.data?.[0]?.saveStatus !== "02" &&
                                        <Button
                                            className="sbmtBtn sbmtBtn_scn psn_btn mt-3 mb-3 ms-3"
                                            type='submit'
                                            onClick={() => handleClickSetAction('02')}
                                            variant="contained"
                                        >
                                            Submit <SaveAsIcon />
                                        </Button>
                                    }
                                </Form>
                            );
                        }}
                    </Formik>
                </div>
            </div>
            <OnlineSnackbar
                open={openSnackbar}
                msg={snackMsg}
                severity={severity}
                handleSnackClose={handleClose}
            />
        </>
    );
};

export default RepossessionDetails;













import { useState, useEffect } from "react";
import { FieldArray, Form, Formik } from 'formik';
import AutoSave from '../../../components/framework/AutoSave';
import { Button, Table, TableBody, TableCell, TableHead, TableRow } from "@mui/material";
import CheckCircleOutlineIcon from '@mui/icons-material/CheckCircleOutline';
import { AdvanceTextBoxField } from "../../../components/framework/AdvanceTextBoxField";
import ConfirmationAlertDialog from "../../../models/application-form/ConfirmationAlertDialog";
import SaveAsIcon from '@mui/icons-material/SaveAs';
import { OnlineSnackbar } from "../../../components/shared/OnlineSnackbar";
import { useSaveRepsessionDetailsMutation, useGetRepsessionDetailQuery } from "../../../features/application-form/Portfoliocuts";
import { useAppSelector } from "../../../app/hooks";

const RepossessionDetails = () => {
    const { applId, transactionData } = useAppSelector((state) => state.userStore);
    const [saveRepsessionDetails] = useSaveRepsessionDetailsMutation();
    const { data: repsessionData } = useGetRepsessionDetailQuery(applId, { refetchOnMountOrArgChange: true });
    const [initialValues, setInitialValues] = useState<any>({ data: [] });
    const [openConfirmation, setOpenConfirmation] = useState(false);
    const [formData, setFormData] = useState<any>("");
    const [actionVal, setActionVal] = useState<any>("");
    const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);
    const [snackMsg, setSnackMsg] = useState<any>("");
    const [severity, setSeverity] = useState<string>("success");

    useEffect(() => {
        if (repsessionData) {
            setInitialValues({ data: repsessionData });
        }
    }, [repsessionData, applId]);

    const handleSubmitApis = async (values: any) => {
        let finalValue = values?.data?.map((listData: any, index: number) => {
            return {
                ...listData,
                applId,
                slNo: index + 1
            };
        });

        try {
            if (await saveRepsessionDetails(finalValue).unwrap()) {
                setOpenSnackbar(true);
                setSeverity("success");
                if (finalValue?.[0]?.saveStatus === '02') {
                    setSnackMsg("Section submitted successfully");
                } else {
                    setSnackMsg("Record saved successfully");
                }
                return true;
            }
        } catch (error: any) {
            setOpenSnackbar(true);
            setSeverity("error");
            setSnackMsg("Failed to save: " + error?.message);
            return false;
        }
    };

    const handleClose = () => {
        setOpenSnackbar(false);
    };

    const handleCloseConfirmation = () => {
        setActionVal(null);
        setOpenConfirmation(false);
    };

    const handleSubmitConfirmation = (values: any) => {
        const finalValue = values?.data?.map((listData: any) => {
            return {
                ...listData,
                saveStatus: '02'
            };
        });
        setOpenConfirmation(false);
        handleSubmitApis(finalValue);
    };

    const handleSubmit = async (values: any) => {
        if (actionVal === '02') {
            setFormData(values);
            setOpenConfirmation(true);
        } else {
            handleSubmitApis(values);
        }
        setActionVal(null);
    };

    const handleClickSetAction = (action: any) => {
        setActionVal(action);
    };

    
    const calculation = (setFieldValue: any, values: any, column: string) => {
        const totalIndex = values.data.findIndex((item: any) => item.particulares === "Total Net");
        if (totalIndex !== -1 && totalIndex > 0) {
            let sum = 0;
            for (let i = 0; i < totalIndex; i++) {
                sum += parseFloat(values.data[i][column]) || 0;
            }
            console.log("totalIndex",totalIndex,sum);
            setFieldValue(`data.${totalIndex}.${column}`, sum.toFixed(2));
        }
    };

    return (
        <>
            <div className="custome-form">
                <ConfirmationAlertDialog
                    id={applId as unknown as number}
                    type={4}
                    open={openConfirmation}
                    handleClose={handleCloseConfirmation}
                    handleDelete={handleSubmitConfirmation}
                    values={formData}
                />
                <div className="wrap-inner-table" style={{ overflow: 'auto' }}>
                    <Formik
                        initialValues={initialValues}
                        onSubmit={handleSubmit}
                        enableReinitialize
                    >
                        {({ values, setFieldValue }) => {
                            return (
                                <Form>
                                    <fieldset disabled={values?.data?.[0]?.saveStatus === "02"}>
                                        {values?.data?.[0]?.saveStatus !== "02" &&
                                            <AutoSave handleSubmit={handleSubmit} values={values} debounceMs={10000} autoStyle={true} />
                                        }
                                        <FieldArray name="data">
                                            {() => (
                                                <Table sx={{ minWidth: 650 }} aria-label="simple table">
                                                    <TableHead>
                                                        <TableRow>
                                                            <TableCell><b>Sr. No.</b></TableCell>
                                                            <TableCell><b>Particulars</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrTm2}</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrTm1}</b></TableCell>
                                                            <TableCell align='center'><b>FY {transactionData?.lstAudYrT}</b></TableCell>
                                                        </TableRow>
                                                    </TableHead>
                                                    <TableBody>
                                                        {values?.data?.map((item: any, index: number) => (
                                                            <TableRow
                                                                key={index}
                                                                sx={item?.particulares === "Total Net" ? {
                                                                    backgroundColor: "gray.100",
                                                                    fontWeight: "bold"
                                                                } : {}}
                                                            >
                                                                <TableCell>{index + 1}</TableCell>
                                                                <TableCell>{item?.particulares}</TableCell>
                                                                <TableCell>
                                                                    <AdvanceTextBoxField
                                                                        name={`data.${index}.valAsonT2`}
                                                                        label={item.particulares === "Total Net" ? "" : "Enter only Number"}
                                                                        onCustomChange={() => item.particulares !== "Total Net" && calculation(setFieldValue, values, 'valAsonT2')}
                                                                        type={'number'}
                                                                        disabled={item.particulares === "Total Net"}
                                                                    />
                                                                </TableCell>
                                                                <TableCell>
                                                                    <AdvanceTextBoxField
                                                                        name={`data.${index}.valAsonT1`}
                                                                        label={item.particulares === "Total Net" ? "" : "Enter only Number"}
                                                                        onCustomChange={() => item.particulares !== "Total Net" && calculation(setFieldValue, values, 'valAsonT1')}
                                                                        type={'number'}
                                                                        disabled={item.particulares === "Total Net"}
                                                                    />
                                                                </TableCell>
                                                                <TableCell>
                                                                    <AdvanceTextBoxField
                                                                        name={`data.${index}.valAsonT`}
                                                                        label={item.particulares === "Total Net" ? "" : "Enter only Number"}
                                                                        onCustomChange={() => item.particulares !== "Total Net" && calculation(setFieldValue, values, 'valAsonT')}
                                                                        type={'number'}
                                                                        disabled={item.particulares === "Total Net"}
                                                                    />
                                                                </TableCell>
                                                            </TableRow>
                                                        ))}
                                                    </TableBody>
                                                </Table>
                                            )}
                                        </FieldArray>
                                    </fieldset>
                                    {values?.data?.[0]?.saveStatus !== "02" &&
                                        <Button
                                            className="sbmtBtn psn_btn mt-3 mb-3 ms-3"
                                            type='submit'
                                            onClick={() => handleClickSetAction('01')}
                                            variant="contained"
                                        >
                                            Save <CheckCircleOutlineIcon />
                                        </Button>
                                    }
                                    {values?.data?.[0]?.saveStatus !== "02" &&
                                        <Button
                                            className="sbmtBtn sbmtBtn_scn psn_btn mt-3 mb-3 ms-3"
                                            type='submit'
                                            onClick={() => handleClickSetAction('02')}
                                            variant="contained"
                                        >
                                            Submit <SaveAsIcon />
                                        </Button>
                                    }
                                </Form>
                            );
                        }}
                    </Formik>
                </div>
            </div>
            <OnlineSnackbar
                open={openSnackbar}
                msg={snackMsg}
                severity={severity}
                handleSnackClose={handleClose}
            />
        </>
    );
};

export default RepossessionDetails;
